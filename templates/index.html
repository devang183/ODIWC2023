<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ODI World Cup 2023 Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: #333;
            min-height: 100vh;
            font-size: 16px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        h1 {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.8em;
            font-weight: 700;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        h2, h3 {
            font-weight: 600;
            letter-spacing: 0.3px;
        }

        p {
            font-size: 1.05em;
            letter-spacing: 0.2px;
        }

        .search-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .search-box {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 300px;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'Times New Roman', Times, serif;
            transition: all 0.3s;
            letter-spacing: 0.3px;
        }

        .search-input:focus {
            outline: none;
            border-color: #36256E;
            box-shadow: 0 0 0 3px rgba(54, 37, 110, 0.1);
        }

        .btn {
            padding: 15px 30px;
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            font-family: 'Times New Roman', Times, serif;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            letter-spacing: 0.5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(54, 37, 110, 0.4);
        }

        /* Auto-complete Styles */
        .autocomplete-items {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 999;
            background: white;
            border: 2px solid #e0e0e0;
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 300px;
            overflow-y: auto;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            margin-top: -2px;
        }

        .autocomplete-items div {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background 0.2s;
        }

        .autocomplete-items div:hover {
            background: #f5f5f5;
        }

        .autocomplete-items div.autocomplete-active {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
        }

        .autocomplete-category {
            font-size: 0.75em;
            text-transform: uppercase;
            color: #999;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .autocomplete-active .autocomplete-category {
            color: rgba(255, 255, 255, 0.8);
        }

        .autocomplete-text {
            flex: 1;
        }

        .autocomplete-text strong {
            font-weight: 600;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
            text-align: center;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: 700;
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab {
            padding: 12px 25px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .tab:hover {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            border-color: #36256E;
            color: white;
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 15px rgba(54, 37, 110, 0.3);
        }

        .tab.active:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(54, 37, 110, 0.4);
        }

        .content-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .content-section.active {
            display: block;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            font-size: 1.05em;
        }

        th {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            font-size: 0.95em;
        }

        td {
            letter-spacing: 0.2px;
        }

        tr:hover {
            background: #f5f5f5;
        }

        tr.highlighted {
            background: #fff3cd !important;
            border-left: 4px solid #36256E;
            box-shadow: 0 2px 8px rgba(54, 37, 110, 0.3);
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
        }

        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        select {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .player-card {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #36256E;
            cursor: pointer;
            transition: all 0.3s;
        }

        .player-card:hover {
            background: #f0f0f0;
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        /* Custom scrollbar for players section */
        #playersContent::-webkit-scrollbar {
            height: 8px;
        }

        #playersContent::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }

        #playersContent::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            border-radius: 10px;
        }

        #playersContent::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #E73493 0%, #36256E 100%);
        }

        /* Alphabet Slider Styles */
        .alphabet-slider {
            display: none; /* Hidden by default, shown on mobile */
            margin-top: 20px;
            padding: 20px 0;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .alphabet-track {
            position: relative;
            padding: 15px 20px;
        }

        .alphabet-letters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 10px 0;
            -webkit-overflow-scrolling: touch;
        }

        .alphabet-letters::-webkit-scrollbar {
            height: 4px;
        }

        .alphabet-letters::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 2px;
        }

        .alphabet-letters::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            border-radius: 2px;
        }

        .alphabet-letter {
            flex-shrink: 0;
            min-width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 600;
            color: #666;
            background: #f5f5f5;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
            -webkit-user-select: none;
            border: 2px solid transparent;
        }

        .alphabet-letter.active {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(54, 37, 110, 0.4);
        }

        .alphabet-letter.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .alphabet-letter:not(.disabled):hover {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            transform: scale(1.05);
        }

        .alphabet-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(54, 37, 110, 0.95);
            color: white;
            font-size: 60px;
            font-weight: 700;
            width: 100px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 9999;
        }

        .alphabet-indicator.visible {
            opacity: 1;
        }

        .player-name {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .country-flag {
            font-size: 1.5em;
            line-height: 1;
            display: inline-flex;
            align-items: center;
        }

        .player-info {
            color: #666;
            font-size: 0.9em;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Player modal should appear above match modal */
        #playerModal {
            z-index: 1100;
        }

        #aiCommentaryModal {
            z-index: 1050;
        }

        .modal-content {
            background: white;
            margin: 20px;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.3s ease-out;
            display: flex;
            flex-direction: column;
            position: relative;
            transition: transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .modal-content.swipe-left {
            animation: swipeOutLeft 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .modal-content.swipe-right {
            animation: swipeOutRight 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .modal-content.swipe-in-left {
            animation: swipeInLeft 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .modal-content.swipe-in-right {
            animation: swipeInRight 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes swipeOutLeft {
            0% {
                transform: translateX(0);
                opacity: 1;
            }
            100% {
                transform: translateX(-100%);
                opacity: 0;
            }
        }

        @keyframes swipeOutRight {
            0% {
                transform: translateX(0);
                opacity: 1;
            }
            100% {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        @keyframes swipeInLeft {
            0% {
                transform: translateX(100%);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes swipeInRight {
            0% {
                transform: translateX(-100%);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .modal-header {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-shrink: 0;
            max-height: 40vh;
            overflow-y: auto;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.8em;
        }

        .modal-header .player-meta {
            font-size: 0.9em;
            opacity: 0.95;
            margin-top: 5px;
        }

        .modal-header .player-description {
            font-size: 0.85em;
            opacity: 0.9;
            margin-top: 12px;
            line-height: 1.5;
            font-style: italic;
            max-width: 800px;
        }

        .player-header-content {
            display: flex;
            align-items: flex-start;
            gap: 25px;
            width: 100%;
        }

        .player-info-text {
            flex: 1;
        }

        .player-info-text::-webkit-scrollbar {
            width: 4px;
        }

        .player-info-text::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        .player-info-text::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
        }

        .player-info-text::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .player-description::-webkit-scrollbar {
            width: 3px;
        }

        .player-description::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }

        .player-description::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
        }

        .player-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.3);
            object-fit: cover;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .close {
            color: white;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            line-height: 1;
        }

        .close:hover {
            transform: scale(1.2);
        }

        .modal-body {
            padding: 30px;
            overflow-y: auto;
            flex: 1;
            min-height: 0;
        }

        .performance-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .performance-tab {
            padding: 12px 20px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            transition: all 0.3s;
        }

        .performance-tab.active {
            color: #36256E;
            border-bottom-color: #36256E;
        }

        .performance-section {
            display: none;
        }

        .performance-section.active {
            display: block;
        }

        .match-performance {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border-left: 4px solid #36256E;
            transition: all 0.3s;
        }

        .match-performance:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .match-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .match-title {
            font-weight: 600;
            font-size: 1.1em;
            color: #333;
        }

        .match-date {
            color: #666;
            font-size: 0.9em;
        }

        .stats-grid-modal {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 10px;
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }

        .stat-item .label {
            font-size: 0.8em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-item .value {
            font-size: 1.4em;
            font-weight: 700;
            color: #36256E;
            margin-top: 5px;
        }

        .no-performance {
            text-align: center;
            padding: 40px;
            color: #999;
            font-style: italic;
        }

        /* Match Scorecard Styles */
        .match-row {
            cursor: pointer;
            transition: all 0.2s;
        }

        .match-row:hover {
            background: #f0f0f0 !important;
            transform: scale(1.01);
        }

        .scorecard-header {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .scorecard-title {
            font-size: 2em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .scorecard-meta {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .scorecard-section {
            margin-bottom: 30px;
        }

        .scorecard-section h3 {
            font-size: 1.4em;
            color: #36256E;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .team-score {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 4px solid #36256E;
        }

        .team-score.winner {
            border-left-color: #28a745;
            background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(40, 167, 69, 0.05) 100%);
        }

        .team-name-header {
            font-size: 1.5em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .team-name-header.winner::after {
            content: " üèÜ";
        }

        .score-display {
            font-size: 2.5em;
            font-weight: 700;
            color: #36256E;
            margin: 10px 0;
        }

        .innings-table {
            width: 100%;
            margin-top: 15px;
        }

        .innings-table th {
            background: #f5f5f5;
            color: #333;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9em;
        }

        .innings-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .player-name-cell {
            font-weight: 600;
            color: #333;
        }

        .player-name-cell[onclick] {
            transition: all 0.2s ease;
        }

        .player-name-cell[onclick]:hover {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: underline;
            transform: translateX(2px);
        }

        .dismissal-cell {
            color: #666;
            font-size: 0.9em;
        }

        .bowler-figures {
            display: inline-block;
            padding: 4px 8px;
            background: #f0f0f0;
            border-radius: 6px;
            font-weight: 600;
            margin-right: 10px;
        }

        .best-figures {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            color: #36256E;
        }

        .match-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .info-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .info-label {
            font-size: 0.85em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .info-value {
            font-size: 1.2em;
            font-weight: 700;
            color: #333;
        }

        /* Head-to-Head Styles */
        .h2h-summary {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
        }

        .h2h-stat-card {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .h2h-team-name {
            font-size: 1.1em;
            font-weight: 700;
            color: #36256E;
            margin-bottom: 10px;
        }

        .h2h-wins {
            font-size: 2.5em;
            font-weight: 700;
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 10px 0;
        }

        .h2h-label {
            font-size: 0.85em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .h2h-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .h2h-table thead {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
        }

        .h2h-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
            letter-spacing: 0.5px;
        }

        .h2h-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .h2h-table tr:hover {
            background: #f9f9f9;
        }

        .h2h-table tr.team1-win {
            background: rgba(54, 37, 110, 0.05);
        }

        .h2h-table tr.team2-win {
            background: rgba(231, 52, 147, 0.05);
        }

        .h2h-table tr:last-child td {
            border-bottom: none;
        }

        /* Best Moments Styles */
        .moments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .moment-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .moment-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
        }

        .moment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(54, 37, 110, 0.3);
            border-color: #36256E;
        }

        .moment-card.century::before {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .moment-card.fifty::before {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .moment-card.five_wickets::before,
        .moment-card.four_wickets::before {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .moment-card.big_hitting::before {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .moment-card.explosive::before {
            background: linear-gradient(135deg, #ff9a56 0%, #ff4d4d 100%);
        }

        .moment-card.economical::before {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }

        .moment-type-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
        }

        .moment-type-badge.century {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .moment-type-badge.fifty {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .moment-type-badge.five_wickets,
        .moment-type-badge.four_wickets {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .moment-type-badge.big_hitting {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .moment-type-badge.explosive {
            background: linear-gradient(135deg, #ff9a56 0%, #ff4d4d 100%);
            color: white;
        }

        .moment-type-badge.economical {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }

        .moment-title {
            font-size: 1.1em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .moment-description {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .moment-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .moment-meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85em;
            color: #888;
        }

        .moment-meta-item strong {
            color: #333;
        }

        .moment-stats {
            display: flex;
            gap: 15px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .moment-stat {
            background: #f9f9f9;
            padding: 10px 15px;
            border-radius: 8px;
            text-align: center;
        }

        .moment-stat-value {
            font-size: 1.5em;
            font-weight: 700;
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .moment-stat-label {
            font-size: 0.75em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 5px;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            body {
                font-size: 14px;
            }

            .container {
                padding: 10px;
            }

            header {
                padding: 20px 15px;
                margin-bottom: 20px;
            }

            h1 {
                font-size: 1.8em;
                margin-bottom: 5px;
            }

            h2 {
                font-size: 1.5em;
            }

            h3 {
                font-size: 1.2em;
            }

            p {
                font-size: 0.95em;
            }

            .search-container {
                padding: 15px;
                margin-bottom: 20px;
            }

            .search-box {
                gap: 10px;
            }

            .search-input {
                min-width: 100%;
                padding: 12px 15px;
                font-size: 14px;
            }

            .btn {
                padding: 12px 20px;
                font-size: 14px;
                width: 100%;
            }

            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }

            .stat-card {
                padding: 10px 8px;
            }

            .stat-value {
                font-size: 1.4em;
            }

            .stat-label {
                font-size: 0.7em;
            }

            .chart-container {
                height: 300px;
                padding: 15px;
            }

            .moments-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .moment-card {
                padding: 15px;
            }

            .tab-buttons {
                flex-wrap: wrap;
                gap: 5px;
            }

            .tab-button {
                padding: 10px 15px;
                font-size: 13px;
                flex: 1 1 calc(50% - 5px);
            }

            .modal-content {
                width: 95%;
                max-width: 95%;
                margin: 20px auto;
                padding: 15px;
            }

            .modal-header {
                padding: 15px;
                max-height: 50vh;
                overflow-y: auto;
            }

            .modal-header h2 {
                font-size: 1.3em;
            }

            .player-header-content {
                flex-direction: row;
                gap: 12px;
            }

            .player-info-text {
                flex: 1;
                min-width: 0;
                max-height: 35vh;
                overflow-y: auto;
                padding-right: 5px;
            }

            .player-description {
                font-size: 0.75em;
                margin-top: 8px;
                max-height: 15vh;
                overflow-y: auto;
            }

            .player-image {
                width: 80px;
                height: 80px;
                border-width: 3px;
            }

            .modal-body {
                padding: 15px;
            }

            .performance-container {
                padding: 15px;
            }

            table {
                font-size: 13px;
            }

            th, td {
                padding: 8px 5px;
            }

            /* Make players section horizontally scrollable on mobile */
            #playersContent {
                display: flex;
                flex-direction: row;
                overflow-x: auto;
                overflow-y: hidden;
                gap: 15px;
                padding-bottom: 15px;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
                scroll-behavior: smooth;
            }

            #playersContent .player-card {
                flex: 0 0 75%;
                min-width: 75%;
                scroll-snap-align: start;
            }

            /* Show alphabet slider on mobile */
            .alphabet-slider {
                display: block;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.5em;
            }

            h2 {
                font-size: 1.3em;
            }

            header {
                padding: 15px 10px;
            }

            .container {
                padding: 8px;
            }

            .search-container {
                padding: 12px;
            }

            .search-input {
                padding: 10px 12px;
                font-size: 13px;
            }

            .btn {
                padding: 10px 15px;
                font-size: 13px;
            }

            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 6px;
            }

            .stat-card {
                padding: 8px 4px;
            }

            .stat-value {
                font-size: 1.2em;
            }

            .stat-label {
                font-size: 0.65em;
                word-break: break-word;
            }

            .chart-container {
                height: 250px;
                padding: 12px;
            }

            .tab-button {
                padding: 8px 12px;
                font-size: 12px;
                flex: 1 1 100%;
            }

            /* Make players section horizontally scrollable on mobile */
            #playersContent {
                display: flex;
                flex-direction: row;
                overflow-x: auto;
                overflow-y: hidden;
                gap: 12px;
                padding-bottom: 15px;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
                scroll-behavior: smooth;
            }

            #playersContent .player-card {
                flex: 0 0 85%;
                min-width: 85%;
                scroll-snap-align: start;
            }

            /* Show alphabet slider on mobile */
            .alphabet-slider {
                display: block;
            }

            .alphabet-letter {
                min-width: 30px;
                height: 30px;
                font-size: 12px;
            }

            .modal-content {
                width: 98%;
                margin: 10px auto;
                padding: 10px;
            }

            .modal-header {
                padding: 12px;
            }

            .modal-header h2 {
                font-size: 1.1em;
            }

            .player-header-content {
                gap: 10px;
            }

            .player-info-text {
                max-height: 30vh;
            }

            .player-description {
                font-size: 0.7em;
                margin-top: 6px;
                max-height: 12vh;
            }

            .player-image {
                width: 60px;
                height: 60px;
                border-width: 2px;
            }

            .player-meta {
                font-size: 0.75em;
            }

            .close {
                font-size: 28px;
            }

            table {
                font-size: 11px;
            }

            th, td {
                padding: 6px 3px;
            }
        }

        /* Blackjack Gate Styles */
        .blackjack-gate {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: auto;
        }

        .blackjack-container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 90%;
            animation: slideDown 0.5s ease-out;
        }

        .blackjack-game {
            margin-top: 20px;
        }

        .dealer-section, .player-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .card-display {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            min-height: 120px;
            flex-wrap: wrap;
        }

        .card {
            width: 70px;
            height: 100px;
            background: white;
            border: 2px solid #333;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: 700;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            animation: dealCard 0.3s ease-out;
        }

        .card.red {
            color: #E73493;
        }

        .card.black {
            color: #333;
        }

        .card.hidden {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
            font-size: 2em;
        }

        @keyframes dealCard {
            from {
                transform: translateY(-50px) rotateY(180deg);
                opacity: 0;
            }
            to {
                transform: translateY(0) rotateY(0);
                opacity: 1;
            }
        }

        .game-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }

        .blackjack-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Times New Roman', Times, serif;
        }

        .blackjack-btn.primary {
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
            color: white;
        }

        .blackjack-btn.secondary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .blackjack-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .blackjack-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .game-message {
            text-align: center;
            font-size: 1.5em;
            font-weight: 700;
            margin-top: 20px;
            min-height: 40px;
        }

        .game-message.win {
            color: #4CAF50;
        }

        .game-message.lose {
            color: #E73493;
        }

        .game-message.push {
            color: #FF9800;
        }

        .player-section.active {
            border: 3px solid #36256E;
            box-shadow: 0 0 20px rgba(54, 37, 110, 0.3);
        }

        .player-section.completed {
            opacity: 0.7;
        }

        /* Mobile Responsive Styles for Blackjack */
        @media screen and (max-width: 768px) {
            .blackjack-container {
                padding: 25px;
                width: 95%;
                max-width: none;
                border-radius: 15px;
            }

            .blackjack-container h1 {
                font-size: 1.5em;
                margin-bottom: 8px;
            }

            .blackjack-container p {
                font-size: 0.9em;
                margin-bottom: 20px;
            }

            .dealer-section, .player-section {
                margin-bottom: 20px;
                padding: 15px;
                border-radius: 8px;
            }

            .dealer-section h3, .player-section h3 {
                font-size: 1.1em;
                margin: 0 0 10px 0;
            }

            .card-display {
                gap: 8px;
                margin-top: 12px;
                min-height: 90px;
                justify-content: center;
            }

            .card {
                width: 55px;
                height: 80px;
                font-size: 1.2em;
                border-radius: 6px;
            }

            .card.hidden {
                font-size: 1.6em;
            }

            .game-controls {
                flex-direction: column;
                gap: 12px;
                margin: 20px 0;
            }

            .blackjack-btn {
                padding: 14px 30px;
                font-size: 1em;
                width: 100%;
            }

            .game-message {
                font-size: 1.2em;
                margin-top: 15px;
            }

            .game-message div {
                font-size: 1.1em;
            }

            .game-message button {
                font-size: 1em;
                padding: 12px 24px;
                margin-top: 12px;
            }
        }

        @media screen and (max-width: 480px) {
            .blackjack-container {
                padding: 20px;
                border-radius: 12px;
            }

            .blackjack-container h1 {
                font-size: 1.3em;
            }

            .blackjack-container p {
                font-size: 0.85em;
            }

            .dealer-section, .player-section {
                padding: 12px;
                margin-bottom: 15px;
            }

            .dealer-section h3, .player-section h3 {
                font-size: 1em;
            }

            .card-display {
                gap: 6px;
                min-height: 75px;
            }

            .card {
                width: 45px;
                height: 65px;
                font-size: 1em;
                border-radius: 5px;
                border-width: 1.5px;
            }

            .card.hidden {
                font-size: 1.3em;
            }

            .game-controls {
                gap: 10px;
                margin: 15px 0;
            }

            .blackjack-btn {
                padding: 12px 24px;
                font-size: 0.95em;
            }

            .game-message {
                font-size: 1em;
            }

            .game-message div {
                font-size: 1em;
            }

            .game-message button {
                font-size: 0.9em;
                padding: 10px 20px;
            }
        }

        /* Horse Racing Gate Styles */
        .horse-racing-gate {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #2ecc71 0%, #3498db 100%);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: auto;
        }

        .horse-racing-container {
            width: 90%;
            max-width: 1000px;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
        }

        .horses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .horse-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .horse-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
            border-color: #E73493;
        }

        .horse-icon {
            font-size: 3em;
            margin-bottom: 10px;
            animation: horseIdle 2s ease-in-out infinite;
        }

        @keyframes horseIdle {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .horse-name {
            font-size: 1.3em;
            font-weight: 700;
            color: #36256E;
            margin: 10px 0;
        }

        .horse-stats {
            color: #666;
            font-size: 0.9em;
        }

        .horse-card.selected {
            border-color: #36256E;
            background: linear-gradient(135deg, #36256E 0%, #E73493 100%);
        }

        .horse-card.selected .horse-name,
        .horse-card.selected .horse-stats {
            color: white;
        }

        .track-container {
            position: relative;
            background: linear-gradient(to bottom, #8B4513 0%, #D2691E 100%);
            border-radius: 15px;
            padding: 30px 20px;
            margin: 30px 0;
            min-height: 500px;
        }

        .finish-line {
            position: absolute;
            right: 30px;
            top: 0;
            bottom: 0;
            width: 8px;
            background: repeating-linear-gradient(
                0deg,
                white 0px,
                white 20px,
                black 20px,
                black 40px
            );
            border-radius: 4px;
        }

        .race-lane {
            position: relative;
            height: 90px;
            background: rgba(255, 255, 255, 0.1);
            margin: 10px 0;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            display: flex;
            align-items: center;
        }

        .lane-number {
            position: absolute;
            left: 10px;
            font-size: 2em;
            font-weight: 700;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .horse-runner {
            position: absolute;
            left: 50px;
            font-size: 2.5em;
            transition: left 0.1s linear;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
        }

        .horse-runner.racing {
            animation: horseRun 0.3s ease-in-out infinite;
        }

        @keyframes horseRun {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        .race-info {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
        }

        .race-result {
            text-align: center;
            margin-top: 30px;
            font-size: 1.2em;
            font-weight: 600;
        }

        /* Mobile Responsive Styles for Horse Racing */
        @media screen and (max-width: 768px) {
            .horse-racing-container {
                width: 95%;
                padding: 20px;
                border-radius: 15px;
            }

            .horse-racing-container h1 {
                font-size: 1.5em;
                margin-bottom: 8px;
            }

            .horse-racing-container p {
                font-size: 0.9em;
                margin-bottom: 20px;
            }

            .horses-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
                margin: 20px 0;
            }

            .horse-card {
                padding: 15px;
                border-radius: 12px;
            }

            .horse-icon {
                font-size: 2.5em;
                margin-bottom: 8px;
            }

            .horse-name {
                font-size: 1.1em;
                margin: 8px 0;
            }

            .horse-stats {
                font-size: 0.8em;
            }

            .track-container {
                padding: 15px 10px;
                margin: 20px 0;
                min-height: 370px;
            }

            .race-info {
                padding: 15px;
                margin-bottom: 15px;
            }

            .race-info h3 {
                font-size: 1.1em;
                margin: 0 0 8px 0;
            }

            .race-info p {
                font-size: 0.9em;
                margin: 0;
            }

            .finish-line {
                right: 15px;
                width: 6px;
            }

            .race-lane {
                height: 65px;
                margin: 8px 0;
            }

            .lane-number {
                left: 8px;
                font-size: 1.5em;
            }

            .horse-runner {
                left: 35px;
                font-size: 2em;
            }

            .race-result {
                margin-top: 20px;
                font-size: 1em;
            }

            .race-result h2 {
                font-size: 1.3em;
                margin-bottom: 10px;
            }

            .race-result p {
                font-size: 0.95em;
                margin-bottom: 15px;
            }

            .race-result button {
                font-size: 1em;
                padding: 12px 24px;
            }
        }

        @media screen and (max-width: 480px) {
            .horse-racing-container {
                padding: 15px;
            }

            .horse-racing-container h1 {
                font-size: 1.3em;
            }

            .horses-grid {
                gap: 10px;
                margin: 15px 0;
            }

            .horse-card {
                padding: 12px;
            }

            .horse-icon {
                font-size: 2em;
            }

            .horse-name {
                font-size: 1em;
            }

            .horse-stats {
                font-size: 0.75em;
            }

            .track-container {
                padding: 10px 8px;
                min-height: 310px;
            }

            .race-lane {
                height: 55px;
                margin: 6px 0;
            }

            .lane-number {
                font-size: 1.2em;
                left: 5px;
            }

            .horse-runner {
                left: 30px;
                font-size: 1.5em;
            }

            .finish-line {
                right: 10px;
                width: 5px;
            }

            .race-result h2 {
                font-size: 1.1em;
            }

            .race-result p {
                font-size: 0.9em;
            }

            .race-result button {
                font-size: 0.95em;
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Blackjack Gate - Must win to access dashboard -->
    <div id="blackjackGate" class="blackjack-gate">
        <div class="blackjack-container">
            <h1 style="text-align: center; color: #36256E; margin-bottom: 10px;">üé∞ Welcome to ODI World Cup 2023</h1>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">Win at Blackjack to unlock the dashboard!</p>

            <div class="blackjack-game">
                <div class="dealer-section">
                    <h3 style="color: #E73493;">Dealer's Hand <span id="dealerScore"></span></h3>
                    <div id="dealerCards" class="card-display"></div>
                </div>

                <div id="playerHandsContainer">
                    <!-- Player hands will be dynamically added here -->
                </div>

                <div class="game-controls">
                    <button id="hitBtn" class="blackjack-btn primary" onclick="hit()">Hit</button>
                    <button id="standBtn" class="blackjack-btn secondary" onclick="stand()">Stand</button>
                    <button id="splitBtn" class="blackjack-btn" style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white; display: none;" onclick="split()">Split</button>
                    <button id="newGameBtn" class="blackjack-btn" onclick="startNewGame()" style="display: none;">New Game</button>
                </div>

                <div id="gameMessage" class="game-message"></div>
            </div>
        </div>
    </div>

    <!-- Horse Racing Gate - Must win to access Best Moments -->
    <div id="horseRacingGate" class="horse-racing-gate" style="display: none;">
        <div class="horse-racing-container">
            <h1 style="text-align: center; color: #36256E; margin-bottom: 10px;">üêé Horse Racing Challenge</h1>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">Pick your horse and win the race to unlock Best Moments!</p>

            <div class="horse-racing-game">
                <div class="horse-selection" id="horseSelection">
                    <h3 style="color: #E73493; text-align: center; margin-bottom: 20px;">Choose Your Horse</h3>
                    <div class="horses-grid">
                        <div class="horse-card" onclick="selectHorse(1)">
                            <div class="horse-icon">üê¥</div>
                            <div class="horse-name">Thunder</div>
                            <div class="horse-stats">Odds: 3/1</div>
                        </div>
                        <div class="horse-card" onclick="selectHorse(2)">
                            <div class="horse-icon">üèá</div>
                            <div class="horse-name">Lightning</div>
                            <div class="horse-stats">Odds: 5/2</div>
                        </div>
                        <div class="horse-card" onclick="selectHorse(3)">
                            <div class="horse-icon">üêé</div>
                            <div class="horse-name">Storm</div>
                            <div class="horse-stats">Odds: 4/1</div>
                        </div>
                        <div class="horse-card" onclick="selectHorse(4)">
                            <div class="horse-icon">ü¶Ñ</div>
                            <div class="horse-name">Blaze</div>
                            <div class="horse-stats">Odds: 2/1</div>
                        </div>
                        <div class="horse-card" onclick="selectHorse(5)">
                            <div class="horse-icon">üé†</div>
                            <div class="horse-name">Spirit</div>
                            <div class="horse-stats">Odds: 7/2</div>
                        </div>
                    </div>
                </div>

                <div class="race-track" id="raceTrack" style="display: none;">
                    <div class="race-info">
                        <h3 style="color: #36256E;">Race in Progress...</h3>
                        <p>Your horse: <strong id="selectedHorseName"></strong></p>
                    </div>

                    <div class="track-container">
                        <div class="finish-line"></div>
                        <div class="race-lane">
                            <div class="lane-number">1</div>
                            <div class="horse-runner" id="horse1">üê¥</div>
                        </div>
                        <div class="race-lane">
                            <div class="lane-number">2</div>
                            <div class="horse-runner" id="horse2">üèá</div>
                        </div>
                        <div class="race-lane">
                            <div class="lane-number">3</div>
                            <div class="horse-runner" id="horse3">üêé</div>
                        </div>
                        <div class="race-lane">
                            <div class="lane-number">4</div>
                            <div class="horse-runner" id="horse4">ü¶Ñ</div>
                        </div>
                        <div class="race-lane">
                            <div class="lane-number">5</div>
                            <div class="horse-runner" id="horse5">üé†</div>
                        </div>
                    </div>

                    <div id="raceResult" class="race-result"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="container" id="mainDashboard" style="display: none;">
        <header>
            <h1>üèè ODI World Cup 2023 Dashboard</h1>
            <p>Comprehensive Statistics & Analytics</p>
        </header>

        <div class="search-container">
            <div class="search-box">
                <div style="position: relative; flex: 1;">
                    <input type="text" id="searchInput" class="search-input" placeholder="Try: 'top batsmen', 'India matches', 'Virat Kohli stats'..." autocomplete="off">
                    <div id="autocomplete-list" class="autocomplete-items"></div>
                </div>
                <button class="btn" onclick="performSearch()">Search</button>
            </div>
        </div>

        <div class="stats-grid" id="statsGrid">
            <div class="stat-card">
                <div class="stat-value" id="totalMatches">-</div>
                <div class="stat-label">Total Matches</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalPlayers">-</div>
                <div class="stat-label">Total Players</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalRuns">-</div>
                <div class="stat-label">Total Runs</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalWickets">-</div>
                <div class="stat-label">Total Wickets</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('players')">Players</div>
            <div class="tab" onclick="switchTab('matches')">Matches</div>
            <div class="tab" onclick="switchTab('batting')">Top Batsmen</div>
            <div class="tab" onclick="switchTab('bowling')">Top Bowlers</div>
            <div class="tab" onclick="switchTab('moments')">Best Moments</div>
        </div>

        <div id="players" class="content-section active">
            <h2>Players</h2>
            <div class="filters">
                <select id="teamFilter" onchange="filterPlayers()">
                    <option value="">All Teams</option>
                </select>
                <select id="roleFilter" onchange="filterPlayers()">
                    <option value="">All Roles</option>
                    <!-- <option value="Batter">Batter</option> -->
                    <option value="Opening Batter">Opening Batter</option>
                    <option value="Top order Batter">Top order Batter</option>
                    <option value="Middle order Batter">Middle order Batter</option>
                    <option value="Wicketkeeper Batter">Wicketkeeper Batter</option>
                    <option value="Allrounder">Allrounder</option>
                    <option value="Batting Allrounder">Batting Allrounder</option>
                    <option value="Bowling Allrounder">Bowling Allrounder</option>
                    <option value="Bowler">Bowler</option>
                </select>
            </div>
            <div id="playersContent"></div>
            <!-- A-Z Alphabet Slider -->
            <div class="alphabet-slider" id="alphabetSlider">
                <div class="alphabet-track">
                    <div class="alphabet-letters" id="alphabetLetters"></div>
                </div>
            </div>
        </div>

        <div id="matches" class="content-section">
            <h2>Match Schedule & Results</h2>
            <div class="filters">
                <select id="matchTeamFilter" onchange="filterMatches()">
                    <option value="">All Teams</option>
                </select>
                <select id="venueFilter" onchange="filterMatches()">
                    <option value="">All Venues</option>
                </select>
            </div>
            <div class="table-container" id="matchesContent"></div>
        </div>

        <div id="batting" class="content-section">
            <h2>Top Run Scorers</h2>
            <div class="chart-container">
                <canvas id="battingChart"></canvas>
            </div>
            <div class="table-container" id="battingContent"></div>
        </div>

        <div id="bowling" class="content-section">
            <h2>Top Wicket Takers</h2>
            <div class="chart-container">
                <canvas id="bowlingChart"></canvas>
            </div>
            <div class="table-container" id="bowlingContent"></div>
        </div>

        <div id="moments" class="content-section">
            <h2>Best Moments</h2>
            <div class="filters">
                <select id="momentTypeFilter" onchange="filterMoments()">
                    <option value="all">All Moments</option>
                    <option value="centuries">Centuries (100+)</option>
                    <option value="fifties">Half-Centuries (50+)</option>
                    <option value="wickets">Wicket Hauls (4+)</option>
                    <option value="sixes">Big Hitting (3+ sixes)</option>
                    <option value="explosive">Explosive Innings (SR 150+)</option>
                    <option value="economy">Economical Bowling</option>
                </select>
            </div>
            <div id="momentsContent" class="moments-grid"></div>
        </div>
    </div>

    <!-- Alphabet Indicator -->
    <div class="alphabet-indicator" id="alphabetIndicator"></div>

    <!-- Player Performance Modal -->
    <div id="playerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="player-header-content">
                    <div class="player-info-text">
                        <h2 id="modalPlayerName"></h2>
                        <div class="player-meta" id="modalPlayerMeta"></div>
                        <div class="player-description" id="modalPlayerDescription"></div>
                    </div>
                    <img id="modalPlayerImage" class="player-image" src="" alt="" style="display: none;">
                </div>
                <span class="close" onclick="closePlayerModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="performance-tabs">
                    <button class="performance-tab active" onclick="switchPerformanceTab('batting')">Batting</button>
                    <button class="performance-tab" onclick="switchPerformanceTab('bowling')">Bowling</button>
                </div>
                <div id="batting-performance" class="performance-section active"></div>
                <div id="bowling-performance" class="performance-section"></div>
            </div>
        </div>
    </div>

    <!-- Match Scorecard Modal -->
    <div id="matchModal" class="modal">
        <div class="modal-content">
            <div class="scorecard-header">
                <div>
                    <div class="scorecard-title" id="modalMatchTitle"></div>
                    <div class="scorecard-meta" id="modalMatchMeta"></div>
                </div>
                <span class="close" onclick="closeMatchModal()" style="position: absolute; right: 30px; top: 30px;">&times;</span>
            </div>
            <div class="modal-body">
                <div id="matchScorecardContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Use relative URL for API calls (works both locally and on Vercel)
        const API_BASE = window.location.hostname === 'localhost'
            ? 'http://localhost:5001/api'
            : '/api';
        let battingChart = null;
        let bowlingChart = null;

        // Initialize dashboard
        async function loadBestMoments() {
            const momentType = document.getElementById('momentTypeFilter').value;

            try {
                const response = await fetch(`${API_BASE}/best-moments?type=${momentType}`);
                const data = await response.json();

                const momentsContent = document.getElementById('momentsContent');

                if (data.moments && data.moments.length > 0) {
                    momentsContent.innerHTML = data.moments.map(moment => {
                        let statsHTML = '';

                        // Build stats based on moment type
                        if (moment.type === 'century' || moment.type === 'fifty' || moment.type === 'big_hitting' || moment.type === 'explosive') {
                            statsHTML = `
                                <div class="moment-stats">
                                    <div class="moment-stat">
                                        <div class="moment-stat-value">${moment.runs}</div>
                                        <div class="moment-stat-label">Runs</div>
                                    </div>
                                    <div class="moment-stat">
                                        <div class="moment-stat-value">${moment.balls}</div>
                                        <div class="moment-stat-label">Balls</div>
                                    </div>
                                    ${moment.fours ? `<div class="moment-stat">
                                        <div class="moment-stat-value">${moment.fours}</div>
                                        <div class="moment-stat-label">4s</div>
                                    </div>` : ''}
                                    ${moment.sixes ? `<div class="moment-stat">
                                        <div class="moment-stat-value">${moment.sixes}</div>
                                        <div class="moment-stat-label">6s</div>
                                    </div>` : ''}
                                    <div class="moment-stat">
                                        <div class="moment-stat-value">${moment.strike_rate.toFixed(1)}</div>
                                        <div class="moment-stat-label">SR</div>
                                    </div>
                                </div>
                            `;
                        } else if (moment.type === 'five_wickets' || moment.type === 'four_wickets' || moment.type === 'economical') {
                            statsHTML = `
                                <div class="moment-stats">
                                    <div class="moment-stat">
                                        <div class="moment-stat-value">${moment.wickets}</div>
                                        <div class="moment-stat-label">Wickets</div>
                                    </div>
                                    <div class="moment-stat">
                                        <div class="moment-stat-value">${moment.runs}</div>
                                        <div class="moment-stat-label">Runs</div>
                                    </div>
                                    <div class="moment-stat">
                                        <div class="moment-stat-value">${moment.overs}</div>
                                        <div class="moment-stat-label">Overs</div>
                                    </div>
                                    <div class="moment-stat">
                                        <div class="moment-stat-value">${moment.economy.toFixed(2)}</div>
                                        <div class="moment-stat-label">Econ</div>
                                    </div>
                                </div>
                            `;
                        }

                        // Get badge label
                        let badgeLabel = '';
                        switch(moment.type) {
                            case 'century': badgeLabel = 'Century'; break;
                            case 'fifty': badgeLabel = 'Half-Century'; break;
                            case 'five_wickets': badgeLabel = '5+ Wickets'; break;
                            case 'four_wickets': badgeLabel = '4 Wickets'; break;
                            case 'big_hitting': badgeLabel = 'Big Hitting'; break;
                            case 'explosive': badgeLabel = 'Explosive'; break;
                            case 'economical': badgeLabel = 'Economical'; break;
                        }

                        return `
                            <div class="moment-card ${moment.type}" onclick="openMatchModal(${moment.match_no})">
                                <span class="moment-type-badge ${moment.type}">${badgeLabel}</span>
                                <div class="moment-title">${moment.title}</div>
                                <div class="moment-description">${moment.description}</div>
                                ${statsHTML}
                                <div class="moment-meta">
                                    <div class="moment-meta-item">
                                        <strong>Team:</strong> ${moment.team}
                                    </div>
                                    <div class="moment-meta-item">
                                        <strong>Match:</strong> ${moment.match}
                                    </div>
                                    <div class="moment-meta-item">
                                        <strong>Venue:</strong> ${moment.venue}
                                    </div>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    momentsContent.innerHTML = '<p style="text-align: center; color: #888; padding: 40px;">No moments found for this filter.</p>';
                }
            } catch (error) {
                console.error('Error loading best moments:', error);
                document.getElementById('momentsContent').innerHTML = '<p style="text-align: center; color: #888; padding: 40px;">Error loading moments. Please try again.</p>';
            }
        }

        function filterMoments() {
            loadBestMoments();
        }

        async function loadOverview() {
            try {
                const response = await fetch(`${API_BASE}/stats/overview`);
                const data = await response.json();
                document.getElementById('totalMatches').textContent = data.total_matches;
                document.getElementById('totalPlayers').textContent = data.total_players;
                document.getElementById('totalRuns').textContent = data.total_runs.toLocaleString();
                document.getElementById('totalWickets').textContent = data.total_wickets;
            } catch (error) {
                console.error('Error loading overview:', error);
            }
        }

        async function loadTeams() {
            try {
                const response = await fetch(`${API_BASE}/teams`);
                const teams = await response.json();
                const teamFilter = document.getElementById('teamFilter');
                const matchTeamFilter = document.getElementById('matchTeamFilter');
                
                teams.forEach(team => {
                    teamFilter.innerHTML += `<option value="${team}">${team}</option>`;
                    matchTeamFilter.innerHTML += `<option value="${team}">${team}</option>`;
                });
            } catch (error) {
                console.error('Error loading teams:', error);
            }
        }

        async function loadVenues() {
            try {
                const response = await fetch(`${API_BASE}/venues`);
                const venues = await response.json();
                const venueFilter = document.getElementById('venueFilter');
                
                venues.forEach(venue => {
                    venueFilter.innerHTML += `<option value="${venue}">${venue}</option>`;
                });
            } catch (error) {
                console.error('Error loading venues:', error);
            }
        }

        // Helper function to get country flag
        function getCountryFlag(teamName) {
            const flags = {
                'India': 'üáÆüá≥',
                'Australia': 'üá¶üá∫',
                'England': 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',
                'Pakistan': 'üáµüá∞',
                'New Zealand': 'üá≥üáø',
                'South Africa': 'üáøüá¶',
                'Sri Lanka': 'üá±üá∞',
                'Bangladesh': 'üáßüá©',
                'Afghanistan': 'üá¶üá´',
                'Netherlands': 'üá≥üá±'
            };
            return flags[teamName.trim()] || 'üèè';
        }

        // Global variables for player navigation
        let currentPlayersList = [];
        let currentPlayerIndex = -1;

        async function loadPlayers() {
            const team = document.getElementById('teamFilter').value;
            const role = document.getElementById('roleFilter').value;

            try {
                const params = new URLSearchParams();
                if (team) params.append('team', team);
                if (role) params.append('role', role);

                const response = await fetch(`${API_BASE}/players?${params}`);
                const players = await response.json();

                // Sort players by name for alphabet slider
                players.sort((a, b) => a.player_name.localeCompare(b.player_name));

                // Store players list globally for modal navigation
                currentPlayersList = players;

                const content = document.getElementById('playersContent');
                content.innerHTML = players.map((player, index) => {
                    const firstLetter = player.player_name.charAt(0).toUpperCase();
                    return `
                    <div class="player-card" data-letter="${firstLetter}" data-index="${index}" onclick="openPlayerModalByIndex(${index})">
                        <div class="player-name">
                            <span class="country-flag">${getCountryFlag(player.team_name)}</span>
                            ${player.player_name}
                        </div>
                        <div class="player-info">
                            <strong>Team:</strong> ${player.team_name} |
                            <strong>Role:</strong> ${player.playingRole} |
                            <strong>Batting:</strong> ${player.battingStyle} |
                            <strong>Bowling:</strong> ${player.bowlingStyle || 'N/A'}
                        </div>
                    </div>
                `}).join('');

                // Initialize alphabet slider
                initAlphabetSlider(players);
            } catch (error) {
                console.error('Error loading players:', error);
            }
        }

        function openPlayerModalByIndex(index) {
            if (index < 0 || index >= currentPlayersList.length) return;

            currentPlayerIndex = index;
            const player = currentPlayersList[index];
            openPlayerModal(player.player_name, player.team_name, player.playingRole);
        }

        function navigateToNextPlayer() {
            navigateToNextPlayerWithAnimation('left');
        }

        function navigateToPreviousPlayer() {
            navigateToPreviousPlayerWithAnimation('right');
        }

        function initAlphabetSlider(players) {
            // Get available letters from players
            const availableLetters = new Set();
            players.forEach(player => {
                const firstLetter = player.player_name.charAt(0).toUpperCase();
                availableLetters.add(firstLetter);
            });

            // Create A-Z letters
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
            const alphabetLettersContainer = document.getElementById('alphabetLetters');

            alphabetLettersContainer.innerHTML = alphabet.map(letter => {
                const isAvailable = availableLetters.has(letter);
                return `<div class="alphabet-letter ${!isAvailable ? 'disabled' : ''}" data-letter="${letter}">${letter}</div>`;
            }).join('');

            // Add click and touch events for alphabet navigation
            const letterElements = alphabetLettersContainer.querySelectorAll('.alphabet-letter:not(.disabled)');
            letterElements.forEach(letterEl => {
                letterEl.addEventListener('click', () => scrollToLetter(letterEl.dataset.letter));
                letterEl.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    scrollToLetter(letterEl.dataset.letter);
                });
            });

            // Add swipe navigation on alphabet bar
            let isSliding = false;
            alphabetLettersContainer.addEventListener('touchstart', () => { isSliding = true; });
            alphabetLettersContainer.addEventListener('touchend', () => {
                isSliding = false;
                hideAlphabetIndicator();
            });
            alphabetLettersContainer.addEventListener('touchmove', (e) => {
                if (isSliding) {
                    const touch = e.touches[0];
                    const element = document.elementFromPoint(touch.clientX, touch.clientY);
                    if (element && element.classList.contains('alphabet-letter') && !element.classList.contains('disabled')) {
                        scrollToLetter(element.dataset.letter);
                    }
                }
            });

            // Add scroll listener to player cards to update active letter
            const playersContent = document.getElementById('playersContent');
            let scrollTimeout;
            playersContent.addEventListener('scroll', () => {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    updateActiveLetter();
                }, 100);
            });
        }

        function scrollToLetter(letter) {
            const playersContent = document.getElementById('playersContent');
            const targetCard = playersContent.querySelector(`[data-letter="${letter}"]`);

            if (targetCard) {
                // Scroll to the card
                targetCard.scrollIntoView({ behavior: 'smooth', inline: 'start', block: 'nearest' });

                // Show alphabet indicator
                showAlphabetIndicator(letter);

                // Highlight active letter
                document.querySelectorAll('.alphabet-letter').forEach(el => el.classList.remove('active'));
                document.querySelector(`.alphabet-letter[data-letter="${letter}"]`)?.classList.add('active');
            }
        }

        function showAlphabetIndicator(letter) {
            const indicator = document.getElementById('alphabetIndicator');
            indicator.textContent = letter;
            indicator.classList.add('visible');

            // Auto-hide after 1 second
            clearTimeout(window.alphabetIndicatorTimeout);
            window.alphabetIndicatorTimeout = setTimeout(() => {
                hideAlphabetIndicator();
            }, 1000);
        }

        function hideAlphabetIndicator() {
            const indicator = document.getElementById('alphabetIndicator');
            indicator.classList.remove('visible');
        }

        function updateActiveLetter() {
            const playersContent = document.getElementById('playersContent');
            const playerCards = playersContent.querySelectorAll('.player-card');

            if (playerCards.length === 0) return;

            // Find the card that is most visible in the viewport
            let mostVisibleCard = null;
            let maxVisibility = 0;

            playerCards.forEach(card => {
                const rect = card.getBoundingClientRect();
                const containerRect = playersContent.getBoundingClientRect();

                // Calculate how much of the card is visible within the container
                const visibleWidth = Math.min(rect.right, containerRect.right) - Math.max(rect.left, containerRect.left);
                const visibility = visibleWidth / rect.width;

                if (visibility > maxVisibility) {
                    maxVisibility = visibility;
                    mostVisibleCard = card;
                }
            });

            if (mostVisibleCard) {
                const letter = mostVisibleCard.dataset.letter;

                // Update active letter in alphabet slider
                document.querySelectorAll('.alphabet-letter').forEach(el => el.classList.remove('active'));
                const activeLetter = document.querySelector(`.alphabet-letter[data-letter="${letter}"]`);
                if (activeLetter) {
                    activeLetter.classList.add('active');

                    // Scroll the alphabet slider to show the active letter
                    activeLetter.scrollIntoView({ behavior: 'smooth', inline: 'center', block: 'nearest' });
                }
            }
        }

        async function loadMatches() {
            const team = document.getElementById('matchTeamFilter').value;
            const venue = document.getElementById('venueFilter').value;
            
            try {
                const params = new URLSearchParams();
                if (team) params.append('team', team);
                if (venue) params.append('venue', venue);
                
                const response = await fetch(`${API_BASE}/matches?${params}`);
                const matches = await response.json();
                
                const content = document.getElementById('matchesContent');
                content.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>Match #</th>
                                <th>Date</th>
                                <th>Venue</th>
                                <th>Teams</th>
                                <th>Winner</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${matches.map(match => `
                                <tr class="match-row" onclick="openMatchModal(${match.Match_no}, '${match.Team1}', '${match.Team2}', '${match.Date}', '${match.Venue}', '${match.Winner || ''}')">
                                    <td>${match.Match_no}</td>
                                    <td>${match.Date}</td>
                                    <td>${match.Venue}</td>
                                    <td>${match.Team1} vs ${match.Team2}</td>
                                    <td><strong>${match.Winner || 'TBD'}</strong></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } catch (error) {
                console.error('Error loading matches:', error);
            }
        }

        async function loadTopBatsmen() {
            try {
                const response = await fetch(`${API_BASE}/batting/top?limit=10`);
                const data = await response.json();

                // Fetch player details to get team names for flags
                const playersResponse = await fetch(`${API_BASE}/players`);
                const allPlayers = await playersResponse.json();

                // Create a map of player name to team
                const playerTeamMap = {};
                allPlayers.forEach(p => {
                    playerTeamMap[p.player_name] = p.team_name;
                });

                // Add team info to batting data
                data.forEach(player => {
                    player.team = playerTeamMap[player.batsman] || '';
                });

                // Create chart
                const ctx = document.getElementById('battingChart');
                if (battingChart) battingChart.destroy();
                
                battingChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.map(d => d.batsman),
                        datasets: [
                            {
                                label: 'Total Runs',
                                data: data.map(d => d.total_runs),
                                backgroundColor: 'rgba(54, 37, 110, 0.8)',
                                borderColor: 'rgba(54, 37, 110, 1)',
                                borderWidth: 2,
                                yAxisID: 'y'
                            },
                            {
                                label: 'Fours (4s)',
                                data: data.map(d => d.total_4s),
                                backgroundColor: 'rgba(102, 126, 234, 0.8)',
                                borderColor: 'rgba(102, 126, 234, 1)',
                                borderWidth: 2,
                                yAxisID: 'y1'
                            },
                            {
                                label: 'Sixes (6s)',
                                data: data.map(d => d.total_6s),
                                backgroundColor: 'rgba(231, 52, 147, 0.8)',
                                borderColor: 'rgba(231, 52, 147, 1)',
                                borderWidth: 2,
                                yAxisID: 'y1'
                            },
                            {
                                label: 'Strike Rate',
                                data: data.map(d => d.strike_rate),
                                backgroundColor: 'rgba(255, 193, 7, 0.8)',
                                borderColor: 'rgba(255, 193, 7, 1)',
                                borderWidth: 2,
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Total Runs'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '4s / 6s / Strike Rate'
                                },
                                grid: {
                                    drawOnChartArea: false
                                }
                            }
                        },
                        onClick: (event, activeElements) => {
                            if (activeElements.length > 0) {
                                const index = activeElements[0].index;
                                highlightBatsmanRow(index);
                            }
                        }
                    }
                });
                
                // Create table
                const content = document.getElementById('battingContent');
                content.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Batsman</th>
                                <th>Runs</th>
                                <th>Balls</th>
                                <th>4s</th>
                                <th>6s</th>
                                <th>Strike Rate</th>
                                <th>Matches</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map((player, index) => `
                                <tr onclick="openPlayerModalByName('${player.batsman}')" style="cursor: pointer;">
                                    <td>${index + 1}</td>
                                    <td>
                                        <span style="font-size: 1.3em; margin-right: 8px;">${getCountryFlag(player.team)}</span>
                                        <strong>${player.batsman}</strong>
                                    </td>
                                    <td>${player.total_runs}</td>
                                    <td>${player.total_balls}</td>
                                    <td>${player.total_4s}</td>
                                    <td>${player.total_6s}</td>
                                    <td>${player.strike_rate.toFixed(2)}</td>
                                    <td>${player.matches}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } catch (error) {
                console.error('Error loading top batsmen:', error);
            }
        }

        async function loadTopBowlers() {
            try {
                const response = await fetch(`${API_BASE}/bowling/top?limit=10`);
                const data = await response.json();

                // Fetch player details to get team names for flags
                const playersResponse = await fetch(`${API_BASE}/players`);
                const allPlayers = await playersResponse.json();

                // Create a map of player name to team
                const playerTeamMap = {};
                allPlayers.forEach(p => {
                    playerTeamMap[p.player_name] = p.team_name;
                });

                // Add team info to bowling data
                data.forEach(player => {
                    player.team = playerTeamMap[player.bowler] || '';
                });

                // Create chart
                const ctx = document.getElementById('bowlingChart');
                if (bowlingChart) bowlingChart.destroy();
                
                bowlingChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.map(d => d.bowler),
                        datasets: [
                            {
                                label: 'Total Wickets',
                                data: data.map(d => d.total_wickets),
                                backgroundColor: 'rgba(54, 37, 110, 0.8)',
                                borderColor: 'rgba(54, 37, 110, 1)',
                                borderWidth: 2,
                                yAxisID: 'y'
                            },
                            {
                                label: 'Average Economy',
                                data: data.map(d => d.economy),
                                backgroundColor: 'rgba(231, 52, 147, 0.8)',
                                borderColor: 'rgba(231, 52, 147, 1)',
                                borderWidth: 2,
                                yAxisID: 'y1'
                            },
                            {
                                label: 'Total Maidens',
                                data: data.map(d => d.total_maidens || 0),
                                backgroundColor: 'rgba(102, 126, 234, 0.8)',
                                borderColor: 'rgba(102, 126, 234, 1)',
                                borderWidth: 2,
                                yAxisID: 'y'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Wickets / Maidens'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Economy Rate'
                                },
                                grid: {
                                    drawOnChartArea: false
                                }
                            }
                        },
                        onClick: (event, activeElements) => {
                            if (activeElements.length > 0) {
                                const index = activeElements[0].index;
                                highlightBowlerRow(index);
                            }
                        }
                    }
                });
                
                // Create table
                const content = document.getElementById('bowlingContent');
                content.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Bowler</th>
                                <th>Wickets</th>
                                <th>Runs</th>
                                <th>Overs</th>
                                <th>Maidens</th>
                                <th>Economy</th>
                                <th>Matches</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.map((player, index) => `
                                <tr onclick="openPlayerModalByName('${player.bowler}')" style="cursor: pointer;">
                                    <td>${index + 1}</td>
                                    <td>
                                        <span style="font-size: 1.3em; margin-right: 8px;">${getCountryFlag(player.team)}</span>
                                        <strong>${player.bowler}</strong>
                                    </td>
                                    <td>${player.total_wickets}</td>
                                    <td>${player.total_runs}</td>
                                    <td>${player.total_overs.toFixed(1)}</td>
                                    <td>${player.total_maidens || 0}</td>
                                    <td>${player.economy.toFixed(2)}</td>
                                    <td>${player.matches}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            } catch (error) {
                console.error('Error loading top bowlers:', error);
            }
        }

        async function performSearch() {
            const query = document.getElementById('searchInput').value.trim();

            // If search is empty, reset to original data
            if (!query) {
                // Find which tab is currently active and reload it
                const activeTab = document.querySelector('.tab.active');
                if (activeTab) {
                    const tabText = activeTab.textContent.toLowerCase();
                    if (tabText.includes('player')) {
                        await loadPlayers();
                    } else if (tabText.includes('match')) {
                        await loadMatches();
                    } else if (tabText.includes('batting') || tabText.includes('batsmen')) {
                        await loadTopBatsmen();
                    } else if (tabText.includes('bowling') || tabText.includes('bowler')) {
                        await loadTopBowlers();
                    } else if (tabText.includes('moment')) {
                        await loadBestMoments();
                    }
                }
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/search?q=${encodeURIComponent(query)}`);
                const results = await response.json();

                // Show results in appropriate sections
                if (results.players && results.players.length > 0) {
                    switchTab('players');
                    displaySearchResults(results);
                } else if (results.matches && results.matches.length > 0) {
                    switchTab('matches');
                    displaySearchResults(results);
                } else {
                    alert('No results found. Try different keywords like "India", "batsmen", "bowlers"');
                }
            } catch (error) {
                console.error('Error performing search:', error);
                alert('Search error. Please try again.');
            }
        }

        function displaySearchResults(results) {
            if (results.players && results.players.length > 0) {
                const content = document.getElementById('playersContent');
                content.innerHTML = '<h3>Search Results</h3>' + results.players.map(player => {
                    if (player.player_name) {
                        return `
                            <div class="player-card" onclick="openPlayerModal('${player.player_name}', '${player.team_name}', '${player.playingRole}')">
                                <div class="player-name">
                                    <span class="country-flag">${getCountryFlag(player.team_name)}</span>
                                    ${player.player_name}
                                </div>
                                <div class="player-info">
                                    <strong>Team:</strong> ${player.team_name} |
                                    <strong>Role:</strong> ${player.playingRole}
                                </div>
                            </div>
                        `;
                    } else {
                        return `
                            <div class="player-card">
                                <div class="player-name">${player._id}</div>
                                <div class="player-info">
                                    ${player.total_runs ? `<strong>Runs:</strong> ${player.total_runs}` : ''}
                                    ${player.total_wickets ? `<strong>Wickets:</strong> ${player.total_wickets}` : ''}
                                </div>
                            </div>
                        `;
                    }
                }).join('');
            }
        }

        function switchTab(tabName) {
            // Check if user is trying to access Best Moments
            if (tabName === 'moments' && !horseRacingUnlocked) {
                showHorseRacing();
                return;
            }

            // Map tab names to their onclick values for precise matching
            const tabMapping = {
                'players': 'Players',
                'matches': 'Matches',
                'batting': 'Top Batsmen',
                'bowling': 'Top Bowlers',
                'moments': 'Best Moments'
            };

            // Update tabs - remove active from all, then add to the clicked one
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
                const expectedText = tabMapping[tabName];
                if (expectedText && tab.textContent.trim() === expectedText) {
                    tab.classList.add('active');
                }
            });

            // Update content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
        }

        function filterPlayers() {
            loadPlayers();
        }

        function filterMatches() {
            loadMatches();
        }

        function highlightBatsmanRow(index) {
            // Remove previous highlights
            document.querySelectorAll('#battingContent tbody tr').forEach(row => {
                row.classList.remove('highlighted');
            });

            // Highlight the selected row (skip header, so index + 1)
            const rows = document.querySelectorAll('#battingContent tbody tr');
            if (rows[index]) {
                rows[index].classList.add('highlighted');
                // Scroll to the row smoothly
                rows[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function highlightBowlerRow(index) {
            // Remove previous highlights
            document.querySelectorAll('#bowlingContent tbody tr').forEach(row => {
                row.classList.remove('highlighted');
            });

            // Highlight the selected row (skip header, so index + 1)
            const rows = document.querySelectorAll('#bowlingContent tbody tr');
            if (rows[index]) {
                rows[index].classList.add('highlighted');
                // Scroll to the row smoothly
                rows[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Modal Functions
        async function openPlayerModalByName(playerName) {
            try {
                // Fetch player details first
                const response = await fetch(`${API_BASE}/players`);
                const players = await response.json();

                const player = players.find(p => p.player_name === playerName);

                if (player) {
                    openPlayerModal(playerName, player.team_name, player.playingRole);
                } else {
                    // If not found in main list, open with placeholder info
                    openPlayerModal(playerName, 'Unknown', 'Unknown');
                }
            } catch (error) {
                console.error('Error fetching player details:', error);
                // Fallback - open modal anyway
                openPlayerModal(playerName, 'Unknown', 'Unknown');
            }
        }

        async function openPlayerModal(playerName, team, role) {
            try {
                // Set player info in modal header
                document.getElementById('modalPlayerName').textContent = playerName;
                document.getElementById('modalPlayerMeta').textContent = `${team} ‚Ä¢ ${role}`;

                // Show loading state
                document.getElementById('batting-performance').innerHTML = '<div class="loading">Loading batting performance...</div>';
                document.getElementById('bowling-performance').innerHTML = '<div class="loading">Loading bowling performance...</div>';

                // Open modal
                document.getElementById('playerModal').classList.add('active');

                // Initialize swipe navigation (only once)
                if (!window.playerModalSwipeInitialized) {
                    initPlayerModalSwipe();
                    window.playerModalSwipeInitialized = true;
                }

                // Fetch player performance
                const url = `${API_BASE}/player/performance/${encodeURIComponent(playerName)}`;
                console.log('Fetching player data from:', url);

                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                console.log('Received player data:', data);

                // Check if there's an error in the response
                if (data.error) {
                    throw new Error(data.error);
                }

                // Display player description
                const descriptionElement = document.getElementById('modalPlayerDescription');
                if (data.description && data.description.trim()) {
                    descriptionElement.textContent = data.description;
                    descriptionElement.style.display = 'block';
                } else {
                    descriptionElement.style.display = 'none';
                }

                // Display player image
                const imageElement = document.getElementById('modalPlayerImage');
                if (data.image && data.image.trim() && data.image !== ' ') {
                    imageElement.src = data.image;
                    imageElement.alt = playerName;
                    imageElement.style.display = 'block';
                } else {
                    imageElement.style.display = 'none';
                }

                // Display batting performance
                displayBattingPerformance(data.batting);

                // Display bowling performance
                displayBowlingPerformance(data.bowling);

            } catch (error) {
                console.error('Error loading player performance:', error);
                const errorMsg = `<div class="no-performance">Error: ${error.message}<br>Please check console for details</div>`;
                document.getElementById('batting-performance').innerHTML = errorMsg;
                document.getElementById('bowling-performance').innerHTML = errorMsg;
            }
        }

        function displayBattingPerformance(battingStats) {
            const container = document.getElementById('batting-performance');

            if (!battingStats || battingStats.length === 0) {
                container.innerHTML = '<div class="no-performance">No batting records found for this player</div>';
                return;
            }

            container.innerHTML = battingStats.map(stat => {
                const matchInfo = stat.match_info || {};
                const teams = matchInfo.Team1 && matchInfo.Team2
                    ? `${matchInfo.Team1.trim()} vs ${matchInfo.Team2.trim()}`
                    : 'Match details unavailable';

                return `
                    <div class="match-performance">
                        <div class="match-header">
                            <div class="match-title">Match ${stat.Match_no || 'N/A'}: ${teams}</div>
                            <div class="match-date">${matchInfo.Date || 'Date unavailable'} ‚Ä¢ ${matchInfo.Venue || 'Venue unavailable'}</div>
                        </div>
                        <div class="stats-grid-modal">
                            <div class="stat-item">
                                <div class="label">Runs</div>
                                <div class="value">${stat.Runs || 0}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">Balls</div>
                                <div class="value">${stat.Balls || 0}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">4s</div>
                                <div class="value">${stat['4s'] || 0}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">6s</div>
                                <div class="value">${stat['6s'] || 0}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">Strike Rate</div>
                                <div class="value">${stat.Balls > 0 ? ((stat.Runs / stat.Balls) * 100).toFixed(2) : '0.00'}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">Dismissal</div>
                                <div class="value" style="font-size: 0.9em;">${stat.Dismissal || 'Not Out'}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function displayBowlingPerformance(bowlingStats) {
            const container = document.getElementById('bowling-performance');

            if (!bowlingStats || bowlingStats.length === 0) {
                container.innerHTML = '<div class="no-performance">No bowling records found for this player</div>';
                return;
            }

            container.innerHTML = bowlingStats.map(stat => {
                const matchInfo = stat.match_info || {};
                const teams = matchInfo.Team1 && matchInfo.Team2
                    ? `${matchInfo.Team1.trim()} vs ${matchInfo.Team2.trim()}`
                    : 'Match details unavailable';

                return `
                    <div class="match-performance">
                        <div class="match-header">
                            <div class="match-title">Match ${stat.Match_no || 'N/A'}: ${teams}</div>
                            <div class="match-date">${matchInfo.Date || 'Date unavailable'} ‚Ä¢ ${matchInfo.Venue || 'Venue unavailable'}</div>
                        </div>
                        <div class="stats-grid-modal">
                            <div class="stat-item">
                                <div class="label">Wickets</div>
                                <div class="value">${stat.Wickets || 0}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">Runs</div>
                                <div class="value">${stat.Runs || 0}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">Overs</div>
                                <div class="value">${stat.Overs ? stat.Overs.toFixed(1) : '0.0'}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">Maidens</div>
                                <div class="value">${stat.Maidens || 0}</div>
                            </div>
                            <div class="stat-item">
                                <div class="label">Economy</div>
                                <div class="value">${stat.Overs > 0 ? (stat.Runs / stat.Overs).toFixed(2) : '0.00'}</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function closePlayerModal() {
            document.getElementById('playerModal').classList.remove('active');
        }

        function initPlayerModalSwipe() {
            const modal = document.getElementById('playerModal');
            const modalContent = modal.querySelector('.modal-content');

            let touchStartX = 0;
            let touchEndX = 0;
            let touchStartY = 0;
            let touchEndY = 0;
            let touchCurrentX = 0;
            let isSwiping = false;

            modalContent.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
                touchStartY = e.changedTouches[0].screenY;
                touchCurrentX = touchStartX;
                isSwiping = false;

                // Remove any existing animation classes
                modalContent.classList.remove('swipe-left', 'swipe-right', 'swipe-in-left', 'swipe-in-right');
            }, { passive: true });

            modalContent.addEventListener('touchmove', (e) => {
                if (!isSwiping) {
                    touchCurrentX = e.changedTouches[0].screenX;
                    const currentY = e.changedTouches[0].screenY;
                    const deltaX = touchCurrentX - touchStartX;
                    const deltaY = currentY - touchStartY;

                    // Determine if this is a horizontal swipe
                    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 10) {
                        isSwiping = true;
                    }
                }

                if (isSwiping) {
                    const deltaX = touchCurrentX - touchStartX;
                    const scrollTop = modalContent.querySelector('.modal-body').scrollTop;

                    // Only apply transform if not scrolling vertically
                    if (scrollTop === 0 || Math.abs(deltaX) > 30) {
                        // Apply real-time transform with resistance
                        const resistance = 0.5; // Add some resistance for natural feel
                        modalContent.style.transform = `translateX(${deltaX * resistance}px)`;
                        modalContent.style.transition = 'none';
                    }
                }
            }, { passive: true });

            modalContent.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].screenX;
                touchEndY = e.changedTouches[0].screenY;

                // Reset transform
                modalContent.style.transform = '';
                modalContent.style.transition = '';

                if (isSwiping) {
                    handleSwipeGesture();
                }

                isSwiping = false;
            }, { passive: true });

            function handleSwipeGesture() {
                const swipeDistanceX = touchEndX - touchStartX;
                const swipeDistanceY = touchEndY - touchStartY;

                // Check if horizontal swipe is dominant (not vertical scroll)
                if (Math.abs(swipeDistanceX) > Math.abs(swipeDistanceY)) {
                    // Minimum swipe distance threshold (80px for smoother feel)
                    if (Math.abs(swipeDistanceX) > 80) {
                        if (swipeDistanceX > 0) {
                            // Swipe right - go to previous player
                            navigateToPreviousPlayerWithAnimation('right');
                        } else {
                            // Swipe left - go to next player
                            navigateToNextPlayerWithAnimation('left');
                        }
                    }
                }
            }
        }

        function navigateToNextPlayerWithAnimation(direction) {
            if (currentPlayersList.length === 0) return;

            const modalContent = document.querySelector('#playerModal .modal-content');

            // Add exit animation
            modalContent.classList.add('swipe-left');

            setTimeout(() => {
                // Loop to the beginning if at the end
                currentPlayerIndex = (currentPlayerIndex + 1) % currentPlayersList.length;
                const player = currentPlayersList[currentPlayerIndex];

                // Remove exit animation and add entrance animation
                modalContent.classList.remove('swipe-left');
                modalContent.classList.add('swipe-in-left');

                // Load new player content
                openPlayerModal(player.player_name, player.team_name, player.playingRole);

                // Remove entrance animation after it completes
                setTimeout(() => {
                    modalContent.classList.remove('swipe-in-left');
                }, 300);
            }, 300);
        }

        function navigateToPreviousPlayerWithAnimation(direction) {
            if (currentPlayersList.length === 0) return;

            const modalContent = document.querySelector('#playerModal .modal-content');

            // Add exit animation
            modalContent.classList.add('swipe-right');

            setTimeout(() => {
                // Loop to the end if at the beginning
                currentPlayerIndex = (currentPlayerIndex - 1 + currentPlayersList.length) % currentPlayersList.length;
                const player = currentPlayersList[currentPlayerIndex];

                // Remove exit animation and add entrance animation
                modalContent.classList.remove('swipe-right');
                modalContent.classList.add('swipe-in-right');

                // Load new player content
                openPlayerModal(player.player_name, player.team_name, player.playingRole);

                // Remove entrance animation after it completes
                setTimeout(() => {
                    modalContent.classList.remove('swipe-in-right');
                }, 300);
            }, 300);
        }

        function switchPerformanceTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.performance-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');

            // Update content sections
            document.querySelectorAll('.performance-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(`${tabName}-performance`).classList.add('active');
        }

        // Match Modal Functions
        async function openMatchModal(matchNo, team1, team2, date, venue, winner) {
            try {
                // Set match info in modal header
                document.getElementById('modalMatchTitle').textContent = `Match ${matchNo}: ${team1.trim()} vs ${team2.trim()}`;
                document.getElementById('modalMatchMeta').textContent = `${date} ‚Ä¢ ${venue}`;

                // Show loading state
                document.getElementById('matchScorecardContent').innerHTML = '<div class="loading">Loading match scorecard...</div>';

                // Open modal
                document.getElementById('matchModal').classList.add('active');

                // Fetch match scorecard
                const url = `${API_BASE}/match/scorecard/${matchNo}`;
                console.log('Fetching match scorecard from:', url);

                const response = await fetch(url);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                console.log('Received match data:', data);

                if (data.error) {
                    throw new Error(data.error);
                }

                // Display match scorecard
                displayMatchScorecard(data, winner);

            } catch (error) {
                console.error('Error loading match scorecard:', error);
                document.getElementById('matchScorecardContent').innerHTML =
                    `<div class="no-performance">Error: ${error.message}<br>Please check console for details</div>`;
            }
        }

        // Helper function to convert cricket overs to balls
        function cricketOversToTotalBalls(overs) {
            const oversInt = Math.floor(overs);
            const ballsRemainder = Math.round((overs - oversInt) * 10);
            return (oversInt * 6) + ballsRemainder;
        }

        // Helper function to convert total balls to cricket overs format
        function totalBallsToCricketOvers(totalBalls) {
            const overs = Math.floor(totalBalls / 6);
            const balls = totalBalls % 6;
            return parseFloat(`${overs}.${balls}`);
        }

        // Helper function to calculate total overs from bowling stats
        function calculateTotalOvers(bowlingStats) {
            if (!bowlingStats || bowlingStats.length === 0) return 0;

            let totalBalls = 0;
            bowlingStats.forEach(stat => {
                if (stat.Overs) {
                    totalBalls += cricketOversToTotalBalls(stat.Overs);
                }
            });

            return totalBallsToCricketOvers(totalBalls);
        }

        function displayMatchScorecard(data, winner) {
            const container = document.getElementById('matchScorecardContent');
            const match = data.match;
            // Use team names from API (which are ordered by innings)
            const team1 = (data.team1_name || match.Team1).trim();
            const team2 = (data.team2_name || match.Team2).trim();
            const winningTeam = winner.trim();

            // Calculate team totals (including extras from bowling)
            const team1Total = calculateTeamTotal(data.team1_batting, data.team2_bowling);
            const team2Total = calculateTeamTotal(data.team2_batting, data.team1_bowling);

            // Calculate total overs correctly from bowling stats
            const team1Overs = calculateTotalOvers(data.team2_bowling);
            const team2Overs = calculateTotalOvers(data.team1_bowling);

            let html = `
                <div class="scorecard-section">
                    <h3>Match Summary</h3>
                    <div class="match-info-grid">
                        <div class="info-item">
                            <div class="info-label">Match Number</div>
                            <div class="info-value">${match.Match_no}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Date</div>
                            <div class="info-value">${match.Date}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Venue</div>
                            <div class="info-value">${match.Venue}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">Winner</div>
                            <div class="info-value">${winningTeam || 'TBD'}</div>
                        </div>
                    </div>
                </div>

                <!-- Team 1 Scorecard -->
                <div class="scorecard-section">
                    <div class="team-score ${winningTeam === team1 ? 'winner' : ''}">
                        <h3 class="team-name-header ${winningTeam === team1 ? 'winner' : ''}">${team1}</h3>
                        <div class="score-display">${team1Total.total}/${team1Total.wickets}</div>
                        <div style="color: #666; font-size: 0.95em; margin-top: 5px;">
                            Extras: ${team1Total.extras} | Overs: ${team1Overs.toFixed(1)}
                        </div>

                        ${displayBattingCard(data.team1_batting, 'Team 1')}
                        ${displayBowlingCard(data.team2_bowling, 'Team 2 Bowling')}
                    </div>
                </div>

                <!-- Team 2 Scorecard -->
                <div class="scorecard-section">
                    <div class="team-score ${winningTeam === team2 ? 'winner' : ''}">
                        <h3 class="team-name-header ${winningTeam === team2 ? 'winner' : ''}">${team2}</h3>
                        <div class="score-display">${team2Total.total}/${team2Total.wickets}</div>
                        <div style="color: #666; font-size: 0.95em; margin-top: 5px;">
                            Extras: ${team2Total.extras} | Overs: ${team2Overs.toFixed(1)}
                        </div>

                        ${displayBattingCard(data.team2_batting, 'Team 2')}
                        ${displayBowlingCard(data.team1_bowling, 'Team 1 Bowling')}
                    </div>
                </div>
            `;

            container.innerHTML = html;

            // Load head-to-head history
            loadHeadToHead(team1, team2);
        }

        async function loadHeadToHead(team1, team2) {
            try {
                const response = await fetch(`${API_BASE}/head-to-head?team1=${encodeURIComponent(team1)}&team2=${encodeURIComponent(team2)}&limit=10`);
                const data = await response.json();

                if (data.success && data.matches && data.matches.length > 0) {
                    const h2hHTML = displayHeadToHead(data);
                    const container = document.getElementById('matchScorecardContent');
                    container.innerHTML += h2hHTML;
                }
            } catch (error) {
                console.error('Error loading head-to-head:', error);
            }
        }

        function displayHeadToHead(data) {
            const summary = data.summary;
            const matches = data.matches;

            return `
                <div class="scorecard-section" style="margin-top: 40px;">
                    <h3 style="color: #36256E; margin-bottom: 20px;">üìä Head-to-Head History (Last ${matches.length} ODI Matches)</h3>

                    <!-- Summary Stats -->
                    <div class="h2h-summary">
                        <div class="h2h-stat-card">
                            <div class="h2h-team-name">${summary.team1}</div>
                            <div class="h2h-wins">${summary.team1_wins}</div>
                            <div class="h2h-label">Wins</div>
                        </div>
                        <div class="h2h-stat-card">
                            <div class="h2h-team-name">Tied/NR</div>
                            <div class="h2h-wins">${summary.no_results}</div>
                            <div class="h2h-label">-</div>
                        </div>
                        <div class="h2h-stat-card">
                            <div class="h2h-team-name">${summary.team2}</div>
                            <div class="h2h-wins">${summary.team2_wins}</div>
                            <div class="h2h-label">Wins</div>
                        </div>
                    </div>

                    <!-- Match History Table -->
                    <div style="margin-top: 30px;">
                        <table class="h2h-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Venue</th>
                                    <th>Match</th>
                                    <th>Winner</th>
                                    <th>Result</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${matches.map(match => `
                                    <tr class="${match.winner === summary.team1 ? 'team1-win' : match.winner === summary.team2 ? 'team2-win' : ''}">
                                        <td style="white-space: nowrap;">${match.match_date}</td>
                                        <td>${match.venue}</td>
                                        <td>
                                            <div style="font-weight: 600;">${match.team1} vs ${match.team2}</div>
                                            <div style="font-size: 0.85em; color: #666;">${match.team1_score} - ${match.team2_score}</div>
                                        </td>
                                        <td><strong>${match.winner}</strong></td>
                                        <td style="font-size: 0.9em;">${match.result}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function calculateTeamTotal(battingStats, oppositionBowling) {
            let battingRuns = 0;
            let totalWickets = 0;
            let totalBalls = 0;

            battingStats.forEach(stat => {
                battingRuns += stat.Runs || 0;
                totalBalls += stat.Balls || 0;
                if (stat.Dismissal && stat.Dismissal !== 'not out' && stat.Dismissal !== 'Not Out') {
                    totalWickets++;
                }
            });

            // Total score = bowling runs conceded (includes extras)
            let totalScore = 0;
            if (oppositionBowling) {
                totalScore = oppositionBowling.reduce((sum, stat) => sum + (stat.Runs || 0), 0);
            }
            const extras = totalScore - battingRuns;

            return {
                total: totalScore,      // Total score (batting + extras)
                wickets: totalWickets,
                balls: totalBalls,
                extras: extras,
                battingRuns: battingRuns
            };
        }

        function displayBattingCard(battingStats, teamName) {
            if (!battingStats || battingStats.length === 0) {
                return '<p class="no-performance">No batting data available</p>';
            }

            return `
                <h4 style="margin-top: 20px; color: #666;">Batting</h4>
                <table class="innings-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Batsman</th>
                            <th>Dismissal</th>
                            <th>Runs</th>
                            <th>Balls</th>
                            <th>4s</th>
                            <th>6s</th>
                            <th>SR</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${battingStats.map(stat => `
                            <tr>
                                <td style="color: #999; font-weight: 600;">${stat.Batting_Position || '-'}</td>
                                <td class="player-name-cell" style="cursor: pointer; color: #36256E; font-weight: 600;" onclick="openPlayerModalByName('${stat.Batsman_Name}')" title="Click to view player details">${stat.Batsman_Name}</td>
                                <td class="dismissal-cell">${stat.Dismissal || 'Not Out'}</td>
                                <td><strong>${stat.Runs || 0}</strong></td>
                                <td>${stat.Balls || 0}</td>
                                <td>${stat['4s'] || 0}</td>
                                <td>${stat['6s'] || 0}</td>
                                <td>${stat.Balls > 0 ? ((stat.Runs / stat.Balls) * 100).toFixed(2) : '0.00'}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        function displayBowlingCard(bowlingStats, teamName) {
            if (!bowlingStats || bowlingStats.length === 0) {
                return '<p class="no-performance">No bowling data available</p>';
            }

            // Find best bowling figures
            let bestBowler = bowlingStats.reduce((best, current) => {
                return (current.Wickets || 0) > (best.Wickets || 0) ? current : best;
            }, bowlingStats[0]);

            return `
                <h4 style="margin-top: 20px; color: #666;">Bowling</h4>
                <table class="innings-table">
                    <thead>
                        <tr>
                            <th>Bowler</th>
                            <th>Overs</th>
                            <th>Maidens</th>
                            <th>Runs</th>
                            <th>Wickets</th>
                            <th>Economy</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${bowlingStats.map(stat => {
                            const isBest = stat.Bowler_Name === bestBowler.Bowler_Name && stat.Wickets > 0;
                            // Convert cricket overs to balls for proper economy calculation
                            const totalBalls = stat.Overs ? cricketOversToTotalBalls(stat.Overs) : 0;
                            const economy = totalBalls > 0 ? ((stat.Runs / totalBalls) * 6).toFixed(2) : '0.00';

                            return `
                                <tr>
                                    <td class="player-name-cell" style="cursor: pointer; color: #36256E; font-weight: 600;" onclick="openPlayerModalByName('${stat.Bowler_Name}')" title="Click to view player details">${stat.Bowler_Name}</td>
                                    <td>${stat.Overs ? stat.Overs.toFixed(1) : '0.0'}</td>
                                    <td>${stat.Maidens || 0}</td>
                                    <td>${stat.Runs || 0}</td>
                                    <td>
                                        <span class="bowler-figures ${isBest ? 'best-figures' : ''}">
                                            ${stat.Wickets || 0}
                                        </span>
                                    </td>
                                    <td>${economy}</td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                </table>
            `;
        }

        function closeMatchModal() {
            document.getElementById('matchModal').classList.remove('active');
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const playerModal = document.getElementById('playerModal');
            const matchModal = document.getElementById('matchModal');

            if (event.target === playerModal) {
                closePlayerModal();
            }
            if (event.target === matchModal) {
                closeMatchModal();
            }
        }

        // Auto-complete functionality
        let autocompleteData = {
            players: [],
            teams: [],
            keywords: ['top batsmen', 'top bowlers', 'batsmen', 'bowlers', 'runs', 'wickets', 'centuries', 'matches']
        };

        let currentFocus = -1;

        // Load auto-complete data
        async function loadAutocompleteData() {
            try {
                const playersResponse = await fetch(`${API_BASE}/players`);
                const players = await playersResponse.json();
                autocompleteData.players = players.map(p => ({
                    name: p.player_name,
                    team: p.team_name,
                    type: 'player'
                }));

                const matchesResponse = await fetch(`${API_BASE}/matches`);
                const matches = await matchesResponse.json();
                const teams = new Set();
                matches.forEach(m => {
                    teams.add(m.Team1.trim());
                    teams.add(m.Team2.trim());
                });
                autocompleteData.teams = Array.from(teams).map(t => ({
                    name: t,
                    type: 'team'
                }));
            } catch (error) {
                console.error('Error loading autocomplete data:', error);
            }
        }

        function autocomplete(input) {
            const val = input.value.toLowerCase();
            closeAllLists();
            if (!val) return false;
            currentFocus = -1;

            const autocompleteList = document.getElementById('autocomplete-list');
            const suggestions = [];

            // Match players
            autocompleteData.players.forEach(player => {
                if (player.name.toLowerCase().includes(val)) {
                    suggestions.push({
                        display: player.name,
                        value: player.name,
                        category: 'Player',
                        flag: getCountryFlag(player.team),
                        type: 'player'
                    });
                }
            });

            // Match teams
            autocompleteData.teams.forEach(team => {
                if (team.name.toLowerCase().includes(val)) {
                    suggestions.push({
                        display: team.name,
                        value: team.name,
                        category: 'Team',
                        flag: getCountryFlag(team.name),
                        type: 'team'
                    });
                }
            });

            // Match keywords
            autocompleteData.keywords.forEach(keyword => {
                if (keyword.toLowerCase().includes(val)) {
                    suggestions.push({
                        display: keyword,
                        value: keyword,
                        category: 'Suggestion',
                        flag: 'üîç',
                        type: 'keyword'
                    });
                }
            });

            // Limit to top 8 suggestions
            const limitedSuggestions = suggestions.slice(0, 8);

            if (limitedSuggestions.length === 0) return false;

            limitedSuggestions.forEach((suggestion, index) => {
                const div = document.createElement('div');

                // Highlight matching text
                const startPos = suggestion.display.toLowerCase().indexOf(val);
                const matchText = suggestion.display.substr(startPos, val.length);
                const beforeMatch = suggestion.display.substr(0, startPos);
                const afterMatch = suggestion.display.substr(startPos + val.length);

                div.innerHTML = `
                    <span class="autocomplete-category">${suggestion.category}</span>
                    <span style="font-size: 1.2em;">${suggestion.flag}</span>
                    <span class="autocomplete-text">
                        ${beforeMatch}<strong>${matchText}</strong>${afterMatch}
                    </span>
                `;

                div.addEventListener('click', function() {
                    input.value = suggestion.value;
                    closeAllLists();
                    performSearch();
                });

                autocompleteList.appendChild(div);
            });
        }

        function closeAllLists() {
            const list = document.getElementById('autocomplete-list');
            list.innerHTML = '';
            currentFocus = -1;
        }

        // Handle keyboard navigation
        document.getElementById('searchInput').addEventListener('input', function() {
            autocomplete(this);
        });

        document.getElementById('searchInput').addEventListener('keydown', function(e) {
            const list = document.getElementById('autocomplete-list');
            let items = list ? list.getElementsByTagName('div') : [];

            if (e.key === 'ArrowDown') {
                e.preventDefault();
                currentFocus++;
                addActive(items);
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                currentFocus--;
                addActive(items);
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (currentFocus > -1 && items[currentFocus]) {
                    items[currentFocus].click();
                } else {
                    performSearch();
                }
            } else if (e.key === 'Escape') {
                closeAllLists();
            }
        });

        function addActive(items) {
            if (!items || items.length === 0) return false;
            removeActive(items);
            if (currentFocus >= items.length) currentFocus = 0;
            if (currentFocus < 0) currentFocus = items.length - 1;
            items[currentFocus].classList.add('autocomplete-active');
            items[currentFocus].scrollIntoView({ block: 'nearest', behavior: 'smooth' });
        }

        function removeActive(items) {
            for (let i = 0; i < items.length; i++) {
                items[i].classList.remove('autocomplete-active');
            }
        }

        // Close autocomplete when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.id !== 'searchInput') {
                closeAllLists();
            }
        });

        // Handle Enter key in search
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        // ========== BLACKJACK GAME LOGIC (WITH SPLITTING) ==========
        let deck = [];
        let playerHands = []; // Array of hands (for splits)
        let currentHandIndex = 0;
        let dealerHand = [];
        let gameOver = false;

        // Card suits and ranks
        const suits = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô£Ô∏è', '‚ô¶Ô∏è'];
        const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const values = {
            'A': 11, '2': 2, '3': 3, '4': 4, '5': 5, '6': 6, '7': 7, '8': 8, '9': 9, '10': 10,
            'J': 10, 'Q': 10, 'K': 10
        };

        // Create and shuffle deck
        function createDeck() {
            const newDeck = [];
            for (let suit of suits) {
                for (let rank of ranks) {
                    newDeck.push({ rank, suit, value: values[rank] });
                }
            }
            return shuffleDeck(newDeck);
        }

        function shuffleDeck(deck) {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
            return deck;
        }

        // Calculate hand score (handle Aces)
        function calculateScore(hand) {
            let score = 0;
            let aces = 0;

            for (let card of hand) {
                score += card.value;
                if (card.rank === 'A') aces++;
            }

            // Adjust for Aces
            while (score > 21 && aces > 0) {
                score -= 10;
                aces--;
            }

            return score;
        }

        // Render cards
        function renderCards(hand, containerId, hideFirst = false) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';

            hand.forEach((card, index) => {
                const cardDiv = document.createElement('div');
                cardDiv.className = 'card';

                if (hideFirst && index === 0) {
                    cardDiv.innerHTML = 'üÇ†';
                    cardDiv.style.background = 'linear-gradient(135deg, #36256E 0%, #E73493 100%)';
                    cardDiv.style.color = 'white';
                } else {
                    const isRed = card.suit === '‚ô•Ô∏è' || card.suit === '‚ô¶Ô∏è';
                    cardDiv.innerHTML = `${card.rank}${card.suit}`;
                    cardDiv.style.color = isRed ? '#E73493' : '#36256E';
                }

                container.appendChild(cardDiv);
            });
        }

        // Render all player hands
        function renderPlayerHands() {
            const container = document.getElementById('playerHandsContainer');
            container.innerHTML = '';

            playerHands.forEach((hand, index) => {
                const handDiv = document.createElement('div');
                handDiv.className = 'player-section';
                handDiv.id = `hand-${index}`;

                if (index === currentHandIndex && !hand.completed) {
                    handDiv.classList.add('active');
                } else if (hand.completed) {
                    handDiv.classList.add('completed');
                }

                const score = calculateScore(hand.cards);
                const handLabel = playerHands.length > 1 ? `Hand ${index + 1}` : 'Your Hand';
                const status = hand.busted ? ' - BUST' : hand.completed ? ` - ${score}` : '';

                handDiv.innerHTML = `
                    <h3 style="color: #36256E;">${handLabel} <span>(${score})${status}</span></h3>
                    <div id="playerCards-${index}" class="card-display"></div>
                `;

                container.appendChild(handDiv);
                renderCards(hand.cards, `playerCards-${index}`);
            });
        }

        // Update dealer score
        function updateDealerScore(hideScore = false) {
            const dealerScore = calculateScore(dealerHand);
            if (hideScore) {
                document.getElementById('dealerScore').textContent = '(?)';
            } else {
                document.getElementById('dealerScore').textContent = `(${dealerScore})`;
            }
        }

        // Check if current hand can split
        function canSplit() {
            if (currentHandIndex >= playerHands.length) return false;
            const hand = playerHands[currentHandIndex];
            if (hand.cards.length !== 2) return false;
            return hand.cards[0].rank === hand.cards[1].rank;
        }

        // Update button visibility
        function updateButtons() {
            const currentHand = playerHands[currentHandIndex];
            const splitBtn = document.getElementById('splitBtn');

            if (canSplit() && !currentHand.completed) {
                splitBtn.style.display = 'inline-block';
            } else {
                splitBtn.style.display = 'none';
            }
        }

        // Start new game
        function startNewGame() {
            deck = createDeck();
            playerHands = [{ cards: [], completed: false, busted: false, result: null }];
            currentHandIndex = 0;
            dealerHand = [];
            gameOver = false;

            // Deal initial cards
            playerHands[0].cards.push(deck.pop());
            dealerHand.push(deck.pop());
            playerHands[0].cards.push(deck.pop());
            dealerHand.push(deck.pop());

            renderPlayerHands();
            renderCards(dealerHand, 'dealerCards', true);
            updateDealerScore(true);

            document.getElementById('gameMessage').innerHTML = '';
            document.getElementById('hitBtn').style.display = 'inline-block';
            document.getElementById('standBtn').style.display = 'inline-block';
            document.getElementById('splitBtn').style.display = 'none';
            document.getElementById('newGameBtn').style.display = 'none';

            updateButtons();

            // Check for immediate blackjack
            if (calculateScore(playerHands[0].cards) === 21) {
                stand();
            }
        }

        // Player hits
        function hit() {
            if (gameOver || currentHandIndex >= playerHands.length) return;

            const currentHand = playerHands[currentHandIndex];
            if (currentHand.completed) return;

            currentHand.cards.push(deck.pop());
            renderPlayerHands();

            const score = calculateScore(currentHand.cards);
            if (score > 21) {
                currentHand.busted = true;
                currentHand.completed = true;
                currentHand.result = 'bust';
                renderPlayerHands();
                moveToNextHand();
            } else if (score === 21) {
                stand();
            } else {
                updateButtons();
            }
        }

        // Split current hand
        function split() {
            if (!canSplit()) return;

            const currentHand = playerHands[currentHandIndex];
            const card1 = currentHand.cards[0];
            const card2 = currentHand.cards[1];

            // Create two new hands
            currentHand.cards = [card1, deck.pop()];
            const newHand = { cards: [card2, deck.pop()], completed: false, busted: false, result: null };

            // Insert new hand right after current hand
            playerHands.splice(currentHandIndex + 1, 0, newHand);

            renderPlayerHands();
            updateButtons();

            // Auto-stand if we hit 21
            if (calculateScore(currentHand.cards) === 21) {
                stand();
            }
        }

        // Move to next hand or end player turn
        function moveToNextHand() {
            currentHandIndex++;

            if (currentHandIndex >= playerHands.length) {
                // All hands played, dealer's turn
                playDealer();
            } else {
                renderPlayerHands();
                updateButtons();

                // Auto-stand if next hand is 21
                if (calculateScore(playerHands[currentHandIndex].cards) === 21) {
                    stand();
                }
            }
        }

        // Player stands on current hand
        function stand() {
            if (gameOver || currentHandIndex >= playerHands.length) return;

            const currentHand = playerHands[currentHandIndex];
            currentHand.completed = true;
            renderPlayerHands();

            moveToNextHand();
        }

        // Dealer plays
        function playDealer() {
            gameOver = true;
            document.getElementById('hitBtn').style.display = 'none';
            document.getElementById('standBtn').style.display = 'none';
            document.getElementById('splitBtn').style.display = 'none';

            // Reveal dealer's card
            renderCards(dealerHand, 'dealerCards');
            updateDealerScore(false);

            // Dealer must hit on 16 or less
            setTimeout(() => dealerPlay(), 500);
        }

        function dealerPlay() {
            let dealerScore = calculateScore(dealerHand);

            if (dealerScore < 17) {
                dealerHand.push(deck.pop());
                renderCards(dealerHand, 'dealerCards');
                updateDealerScore(false);
                setTimeout(() => dealerPlay(), 500);
            } else {
                determineWinners();
            }
        }

        // Determine winners for all hands
        function determineWinners() {
            const dealerScore = calculateScore(dealerHand);
            const dealerBusted = dealerScore > 21;
            let anyWin = false;

            playerHands.forEach(hand => {
                if (hand.busted) {
                    hand.result = 'lose';
                } else {
                    const playerScore = calculateScore(hand.cards);

                    if (dealerBusted || playerScore > dealerScore) {
                        hand.result = 'win';
                        anyWin = true;
                    } else if (playerScore < dealerScore) {
                        hand.result = 'lose';
                    } else {
                        hand.result = 'push';
                    }
                }
            });

            showFinalResults(anyWin);
        }

        // Show final results
        function showFinalResults(anyWin) {
            const messageDiv = document.getElementById('gameMessage');
            const dealerScore = calculateScore(dealerHand);

            let resultsHTML = '<div style="margin-top: 20px;">';
            resultsHTML += `<h3 style="color: #36256E;">Final Results - Dealer: ${dealerScore}</h3>`;
            resultsHTML += '<div style="margin: 15px 0;">';

            playerHands.forEach((hand, index) => {
                const score = calculateScore(hand.cards);
                const handLabel = playerHands.length > 1 ? `Hand ${index + 1}` : 'Your Hand';
                let resultText = '';
                let resultColor = '';

                if (hand.result === 'win') {
                    resultText = '‚úÖ WIN';
                    resultColor = '#28a745';
                } else if (hand.result === 'lose' || hand.result === 'bust') {
                    resultText = hand.busted ? 'üí• BUST' : '‚ùå LOSE';
                    resultColor = '#dc3545';
                } else {
                    resultText = 'ü§ù PUSH';
                    resultColor = '#ffc107';
                }

                resultsHTML += `<div style="padding: 10px; margin: 5px 0; background: #f9f9f9; border-radius: 8px;">
                    <strong>${handLabel}:</strong> ${score} - <span style="color: ${resultColor}; font-weight: 700;">${resultText}</span>
                </div>`;
            });

            resultsHTML += '</div>';

            if (anyWin) {
                resultsHTML += `
                    <div style="color: #28a745; font-size: 1.5em; font-weight: 700; margin: 20px 0;">
                        üéâ You Won with at least one hand!
                    </div>
                    <button class="blackjack-btn primary" onclick="unlockDashboard()" style="font-size: 1.1em;">
                        Access Cricket Dashboard ‚Üí
                    </button>
                `;
            } else {
                resultsHTML += `
                    <div style="color: #dc3545; font-size: 1.3em; font-weight: 700; margin: 20px 0;">
                        üò¢ All hands lost - Try Again!
                    </div>
                `;
                document.getElementById('newGameBtn').style.display = 'inline-block';
            }

            resultsHTML += '</div>';
            messageDiv.innerHTML = resultsHTML;
        }

        // Unlock dashboard
        function unlockDashboard() {
            document.getElementById('blackjackGate').style.display = 'none';
            document.getElementById('mainDashboard').style.display = 'block';
            init();
        }

        // ========== END BLACKJACK GAME LOGIC ==========

        // ========== HORSE RACING GAME LOGIC ==========
        let selectedHorseNumber = null;
        let raceInProgress = false;
        let horseRacingUnlocked = false;
        const horseNames = ['Thunder', 'Lightning', 'Storm', 'Blaze', 'Spirit'];

        function selectHorse(horseNumber) {
            if (raceInProgress) return;

            selectedHorseNumber = horseNumber;

            // Update visual selection
            document.querySelectorAll('.horse-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.horse-card').classList.add('selected');

            // Show race track after selection
            setTimeout(() => {
                document.getElementById('horseSelection').style.display = 'none';
                document.getElementById('raceTrack').style.display = 'block';
                document.getElementById('selectedHorseName').textContent = horseNames[horseNumber - 1];
                startRace();
            }, 500);
        }

        function startRace() {
            raceInProgress = true;
            const horses = [1, 2, 3, 4, 5];
            const horseElements = horses.map(h => document.getElementById(`horse${h}`));

            // Responsive starting positions and finish line based on screen width
            let startPos, finishLine;
            if (window.innerWidth <= 480) {
                startPos = 30;
                finishLine = 250; // Small mobile
            } else if (window.innerWidth <= 768) {
                startPos = 35;
                finishLine = 400; // Tablet/mobile
            } else {
                startPos = 50;
                finishLine = 850; // Desktop
            }

            const positions = [startPos, startPos, startPos, startPos, startPos];
            let winner = null;

            // Add racing animation class
            horseElements.forEach(el => el.classList.add('racing'));

            // Race animation (slower for excitement)
            const raceInterval = setInterval(() => {
                let raceFinished = false;

                horses.forEach((horseNum, index) => {
                    if (positions[index] < finishLine) {
                        // Slower, more varied speed for excitement
                        const speed = Math.random() * 8 + 4;
                        positions[index] += speed;
                        horseElements[index].style.left = positions[index] + 'px';

                        // Check if horse crossed finish line
                        if (positions[index] >= finishLine && !winner) {
                            winner = horseNum;
                            raceFinished = true;
                        }
                    }
                });

                // End race when winner is determined
                if (raceFinished) {
                    clearInterval(raceInterval);
                    horseElements.forEach(el => el.classList.remove('racing'));
                    endRace(winner);
                }
            }, 150);
        }

        function endRace(winner) {
            raceInProgress = false;
            const resultDiv = document.getElementById('raceResult');
            const winnerName = horseNames[winner - 1];

            if (winner === selectedHorseNumber) {
                // Player won!
                horseRacingUnlocked = true;
                resultDiv.innerHTML = `
                    <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); padding: 30px; border-radius: 15px; color: white; margin-top: 30px;">
                        <h2 style="margin: 0 0 15px 0;">üèÜ Congratulations! Your horse ${winnerName} won!</h2>
                        <p style="font-size: 1.1em; margin-bottom: 20px;">Best Moments section is now unlocked!</p>
                        <button class="blackjack-btn primary" onclick="closeHorseRacing()" style="background: white; color: #28a745; font-size: 1.1em;">
                            Continue to Dashboard
                        </button>
                    </div>
                `;
            } else {
                // Player lost
                resultDiv.innerHTML = `
                    <div style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); padding: 30px; border-radius: 15px; color: white; margin-top: 30px;">
                        <h2 style="margin: 0 0 15px 0;">üòû ${winnerName} won the race!</h2>
                        <p style="font-size: 1.1em; margin-bottom: 20px;">Your horse came in behind. Try again!</p>
                        <button class="blackjack-btn" onclick="resetHorseRace()" style="background: white; color: #dc3545; font-size: 1.1em;">
                            Race Again
                        </button>
                    </div>
                `;
            }
        }

        function resetHorseRace() {
            selectedHorseNumber = null;
            raceInProgress = false;

            // Reset positions (responsive)
            let resetPos;
            if (window.innerWidth <= 480) {
                resetPos = '30px';
            } else if (window.innerWidth <= 768) {
                resetPos = '35px';
            } else {
                resetPos = '50px';
            }

            [1, 2, 3, 4, 5].forEach(h => {
                document.getElementById(`horse${h}`).style.left = resetPos;
            });

            // Show selection screen again
            document.getElementById('raceTrack').style.display = 'none';
            document.getElementById('horseSelection').style.display = 'block';
            document.getElementById('raceResult').innerHTML = '';

            // Remove selection
            document.querySelectorAll('.horse-card').forEach(card => {
                card.classList.remove('selected');
            });
        }

        function closeHorseRacing() {
            document.getElementById('horseRacingGate').style.display = 'none';
            // Switch to Best Moments tab after closing
            switchTab('moments');
        }

        function showHorseRacing() {
            if (!horseRacingUnlocked) {
                document.getElementById('horseRacingGate').style.display = 'flex';
                resetHorseRace();
            }
        }

        // ========== END HORSE RACING GAME LOGIC ==========

        // Initialize on page load
        async function init() {
            await loadOverview();
            await loadTeams();
            await loadVenues();
            await loadPlayers();
            await loadMatches();
            await loadTopBatsmen();
            await loadTopBowlers();
            await loadBestMoments();
            await loadAutocompleteData();
        }

        // Start Blackjack game immediately
        window.onload = function() {
            startNewGame();
        };
    </script>
</body>
</html>